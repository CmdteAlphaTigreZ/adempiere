FROM adoptopenjdk:11-jdk

#Arguments for Build
ARG ADEMPIERE_APPS=apache-tomcat-9.0.60.tar.gz
ARG ADEMPIERE_APPS_TYPE=tomcat
ARG ADEMPIERE_BINARY=Adempiere_393LTS.tar.gz

#Environments Variables
ENV ADEMPIERE_DB_HOST localhost
ENV ADEMPIERE_DB_PORT 5432
ENV ADEMPIERE_DB_NAME adempiere
ENV ADEMPIERE_DB_USER adempiere
ENV ADEMPIERE_DB_PASSWORD adempiere
ENV ADEMPIERE_DB_ADMIN_PASSWORD postgres
ENV ADEMPIERE_WEB_PORT 8888
ENV ADEMPIERE_SSL_PORT 4443
ENV ADEMPIERE_JAVA_OPTIONS -Xms128m -Xmx1024m
ENV ADEMPIERE_BINARY $ADEMPIERE_BINARY
ENV ADEMPIERE_HOME /opt/Adempiere
ENV ADEMPIERE_APPS_TYPE $ADEMPIERE_APPS_TYPE
ENV ADEMPIERE_APPS_PATH /opt/binaryapps/
ENV ADEMPIERE_APPS $ADEMPIERE_APPS

#Set Workdir
WORKDIR $ADEMPIERE_HOME

#Copy Binary File
ADD $ADEMPIERE_BINARY /opt/
ADD $ADEMPIERE_APPS $ADEMPIERE_APPS_PATH

#Copy Utilities
COPY setting.sh /opt/
COPY entrypoint.sh /opt/

ENTRYPOINT /opt/entrypoint.sh

RUN /opt/setting.sh